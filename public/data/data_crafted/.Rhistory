source("0_header.R")
source("0_header.R")
is_not_empty <- function(string) {
if(is.na(string) | string == "" | string == ".") {
return(FALSE)
} else {
return(TRUE)
}
}
is_not_empty = Vectorize(is_not_empty)
(source_data <- read_csv("data/all.csv",
col_types = cols(.default = "c")))
same_data <-
source_data %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))) %>%
mutate(last_name = str_c(last_name, name_sufx_cd, sep = " "),
file_id = str_c(src, file_id, sep = "-")) %>%
mutate_each(funs(str_trim(.))) %>%
select(ID, voter_reg_num, last_name, first_name, dob, race, type, everything(), -name_sufx_cd,-src) %T>%
View()
write_csv(same_data, "./data/all_no_stars.csv")
View(same_data)
starred_data <- read_csv("../all_starred_data.csv")
starred_data <- read_csv("../all_starred.csv")
starred_data
View(starred_data)
View(starred_data)
lookup <- starred_data %>%
select(`Group ID`,type) %>%
unique()
(lookup <- starred_data %>%
select(`Group ID`,type) %>%
unique())
(lookup <- starred_data %>%
select(type,`Group ID`) %>%
unique() %>%
arrange(type))
(lookup <- starred_data %>%
select(type,`Group ID`) %>%
unique() %>%
arrange(type,`Group ID`))
View(lookup)
View(source_data)
View(source_data)
system("C:/Python27/python.exe rdiff_new.py")
system("C:/Python27/python.exe ../rdiff_new.py")
system("C:/Python27/python.exe ../rdiff_new.py")
sampling_matrix <- matrix(ncol = n_samples, nrow = length(unique(lookup$type)))
n_samples <- 10
n_group_observations <- 1
sampling_matrix <- matrix(ncol = n_samples, nrow = length(unique(lookup$type)))
View(sampling_matrix)
colnames(sampling_matrix) <- as.character(1:n_samples)
View(sampling_matrix)
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
paste0("sample_",as.character(1:n_samples))
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
View(sampling_matrix)
n_error_types <- length(unique(lookup$type))
rownames(sampling_matrix) <- paste0("type_",as.character(1:n_error_types))
View(sampling_matrix)
lookup %>%
group_by(type) %>%
sample_n(1)
lookup %>%
group_by(type) %>%
sample_n(2)
lookup %>%
group_by(type) %>%
sample_n(2, replace = TRE)
lookup %>%
group_by(type) %>%
sample_n(2, replace = TRUE)
rownames(sampling_matrix) <- paste0("type_",sort(rep(as.character(1:n_error_types),n_group_observations)))
View(sampling_matrix)
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
View(sampling_matrix)
n_group_observations <- 2
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
n_group_observations <- 1
n_error_types <- length(unique(lookup$type))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
lookup %>%
group_by(type) %>%
sample_n(n_group_observations)
lookup %>%
group_by(type) %>%
sample_n(n_group_observations)
lookup %>%
group_by(type) %>%
sample_n(n_group_observations)
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
set.seed(1)
for(i in 1:n_samples) {
sampling_matrix[,i]
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
}
sampling_matrix
set.seed(1)
for(i in 1:n_samples) {
sampling_matrix[,i]
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
}
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
for(i in 1:n_samples) {
sampling_matrix[,i] <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
}
View(sampling_matrix)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type) %>%
write_csv(paste0("./samples/sample_",i,".csv"))
}
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type) %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
diamonds
names(diamonds)
x <- names(diamonds)
x[1] <- "x"
x
names(diamonds) <- x
diamonds
starred_data <- read_csv("../all_starred.csv")
>read_csv
?read_csv
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
(starred_data <- read_csv("../all_starred.csv", col_types = cols(.default = "c")) %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))))
(lookup <- starred_data %>%
select(type,`Group ID`) %>%
unique() %>%
arrange(type,`Group ID`))
n_samples <- 10
n_group_observations <- 1
n_error_types <- length(unique(lookup$type))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
