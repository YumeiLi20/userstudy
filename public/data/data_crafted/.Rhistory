sample_n(2, replace = TRE)
lookup %>%
group_by(type) %>%
sample_n(2, replace = TRUE)
rownames(sampling_matrix) <- paste0("type_",sort(rep(as.character(1:n_error_types),n_group_observations)))
View(sampling_matrix)
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
View(sampling_matrix)
n_group_observations <- 2
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
n_group_observations <- 1
n_error_types <- length(unique(lookup$type))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
lookup %>%
group_by(type) %>%
sample_n(n_group_observations)
lookup %>%
group_by(type) %>%
sample_n(n_group_observations)
lookup %>%
group_by(type) %>%
sample_n(n_group_observations)
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
set.seed(1)
for(i in 1:n_samples) {
sampling_matrix[,i]
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
}
sampling_matrix
set.seed(1)
for(i in 1:n_samples) {
sampling_matrix[,i]
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
}
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
for(i in 1:n_samples) {
sampling_matrix[,i] <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
}
View(sampling_matrix)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type) %>%
write_csv(paste0("./samples/sample_",i,".csv"))
}
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type) %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
diamonds
names(diamonds)
x <- names(diamonds)
x[1] <- "x"
x
names(diamonds) <- x
diamonds
starred_data <- read_csv("../all_starred.csv")
>read_csv
?read_csv
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
(starred_data <- read_csv("../all_starred.csv", col_types = cols(.default = "c")) %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))))
(lookup <- starred_data %>%
select(type,`Group ID`) %>%
unique() %>%
arrange(type,`Group ID`))
n_samples <- 10
n_group_observations <- 1
n_error_types <- length(unique(lookup$type))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
source("0_header.R")
is_not_empty <- function(string) {
if(is.na(string) | string == "" | string == ".") {
return(FALSE)
} else {
return(TRUE)
}
}
is_not_empty = Vectorize(is_not_empty)
(source_data <- read_csv("data/all.csv",
col_types = cols(.default = "c")))
same_data <-
source_data %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))) %>%
mutate(last_name = str_c(last_name, name_sufx_cd, sep = " "),
file_id = str_c(src, file_id, sep = "-")) %>%
mutate_each(funs(str_trim(.))) %>%
select(ID, voter_reg_num, last_name, first_name, dob, race, type,
everything(), -name_sufx_cd,-src) %T>%
View()
View(same_data)
same_data %>%
group_by(ID) %>%
mutate(answer =
rep(sample(c(0,1),1),2))
same_data %>%
count(ID) %>%
arrange(n)
same_data %>%
count(ID) %>%
arrange(desc(n))
group_by(ID) %>%
mutate(answer =
rep(sample(c(0,1),1),2))
same_data %>%
filter(!(ID %in% four_grp))
four_grp <-
same_data %>%
count(ID) %>%
arrange(desc(n)) %$%
ID
same_data %>%
filter(!(ID %in% four_grp))
four_grp
four_grp <-
same_data %>%
count(ID) %>%
arrange(desc(n)) %>%
filter(n>2) %$%
ID
four_grp
same_data %>%
filter(!(ID %in% four_grp))
group_by(ID) %>%
mutate(answer =
rep(sample(c(0,1),1),2)) %T>%
View()
four_grp <-
same_data %>%
count(ID) %>%
arrange(desc(n)) %>%
filter(n>2) %$%
ID
same_data %>%
filter(!(ID %in% four_grp))
group_by(ID) %>%
mutate(answer =
rep(sample(c(0,1),1),2)) %T>%
View()
same_data %>%
filter(!(ID %in% four_grp)) %>%
group_by(ID) %>%
mutate(answer =
rep(sample(c(0,1),1),2)) %T>%
View()
write_csv(same_data, "./data/all_no_stars.csv")
write_csv(same_data, "./data/all_no_stars.csv")
same_data <-
same_data %>%
filter(!(ID %in% four_grp)) %>%
group_by(ID) %>%
mutate(answer =
rep(sample(c(0,1),1),2)) %T>%
View()
same_data
write_csv(same_data, "./data/all_no_stars.csv")
(starred_data <- read_csv("../all_starred.csv", col_types = cols(.default = "c")) %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))))
View(starred_data)
(starred_data <- read_csv("../all_starred_race.csv", col_types = cols(.default = "c")) %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))))
View(starred_data)
View(starred_data)
(starred_data <- read_csv("../all_starred_race.csv", col_types = cols(.default = "c")) %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))))
View(starred_data)
starred_data %>%
filter(Race_1 != "*") %>%
arrange(`Group ID`)
(lookup <- starred_data %>%
select(type,`Group ID`) %>%
unique() %>%
arrange(type,`Group ID`)) %>%
View()
starred_data %>%
filter(Race_1 != "*") %>%
arrange(`Group ID`) %>%
View()
(lookup <- starred_data %>%
select(type,`Group ID`) %>%
unique() %>%
arrange(type,`Group ID`))
n_samples <- 10
n_group_observations <- 1
n_error_types <- length(unique(lookup$type))
sampling_matrix <- matrix(ncol = n_samples, nrow = n_error_types*n_group_observations)
colnames(sampling_matrix) <- paste0("sample_",as.character(1:n_samples))
rownames(sampling_matrix) <- paste0("type_",(rep(as.character(1:n_error_types),n_group_observations)))
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID","Record ID","First Name",
"FF","Last Name","LF","Reg No.","DoB",
"First Name","Last Name","Reg No.","DoB")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
source('C:/Users/gurud/Google Drive/Research Assistantship/seq/Gurudev Ilangovan/Record Linkage/userstudy/public/data/data_crafted/new_pipeline.R', echo=TRUE)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name","LF",
"Reg No.","DoB",
"First Name","Last Name",
"Reg No.","DoB",
"Race","Answer")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
(starred_data <- read_csv("../all_starred_race.csv", col_types = cols(.default = "c")) %>%
mutate_each(funs(ifelse(is_not_empty(.),.,""))))
starred_data %>%
filter(Race_1 != "*") %>%
arrange(`Group ID`) %>%
View()
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
sampled_data <-
sampled_data %>%
sample_n(n_error_types*n_group_observations) %>%
mutate(`Group ID` = 1:n())
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
qnum_lookup <- tibble(gids,qnum)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
#randomize the order
`Group ID` <- sample(gids,length(gids),replace = F)
qnum <- 1:length(gids)
qnum_lookup <- tibble(`Group ID`,qnum)
sampled_data <-
sampled_data %>%
left_join(qnum_lookup) %>%
mutate(`Group ID` = qnum) %>%
select(-qnum)
#make the names standard
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
set.seed(1)
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
#randomize the order
`Group ID` <- sample(gids,length(gids),replace = F)
qnum <- 1:length(gids)
qnum_lookup <- tibble(`Group ID`,qnum)
sampled_data <-
sampled_data %>%
left_join(qnum_lookup, by = "Group ID") %>%
mutate(`Group ID` = qnum) %>%
select(-qnum) %>%
arrange(`Group ID`)
#make the names standard
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
sampled_data %>%
write_csv(paste0("../samples/sample_",i,".csv"))
}
sprintf("name_%03d",3,".csv")
paste0(sprintf("name_%03d",3),".csv")
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
#randomize the order
`Group ID` <- sample(gids,length(gids),replace = F)
qnum <- 1:length(gids)
qnum_lookup <- tibble(`Group ID`,qnum)
sampled_data <-
sampled_data %>%
left_join(qnum_lookup, by = "Group ID") %>%
mutate(`Group ID` = qnum) %>%
select(-qnum) %>%
arrange(`Group ID`)
#make the names standard
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
sprintf("name_%02d", a)
sampled_data %>%
write_csv(paste0(sprintf("../samples/sample_%02d",i),".csv"))
}
set.seed(1)
for(i in 1:n_samples) {
gids  <-
lookup %>%
group_by(type) %>%
sample_n(n_group_observations) %$%
`Group ID`
sampling_matrix[,i] <- gids
sampled_data <-
starred_data %>%
filter(`Group ID` %in% gids) %>%
select(-type)
#randomize the order
`Group ID` <- sample(gids,length(gids),replace = F)
qnum <- 1:length(gids)
qnum_lookup <- tibble(`Group ID`,qnum)
sampled_data <-
sampled_data %>%
left_join(qnum_lookup, by = "Group ID") %>%
mutate(`Group ID` = qnum) %>%
select(-qnum) %>%
arrange(`Group ID`)
#make the names standard
names(sampled_data) <- c("Group ID", "Record ID",
"First Name", "FF",
"Last Name", "LF",
"Reg No.", "DoB", "Race",
"First Name", "Last Name",
"Reg No.", "DoB", "Race",
"Answer")
sampled_data %>%
write_csv(paste0(sprintf("../samples/sample_%02d",i),".csv"))
}
