<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
    #submitComments {
        position: relative;
        left: 50%;
        transform: translate(-50%, 0%);
    }
    body{
        color:#000;
    }
    #container{
        /*Styling for any element with the id="container" */
        width:1800px; /* The width is fixed by pixels */
        height:800px; /* The height is fixed by pixels*/
        color:black;
    }
</style>
<body>
<div id="container">
    <div id="instruction" style="text-align:center;">
        <h1 id="heading">Main Study</h1>
        <div id="notation" style="text-align:left;">
            <!--<label id="page"></label>-->
        </div>
        <br> <br>
        <div id="table"></div>
    </div>
    <br>
    <button id="submitComments" class="next-button" type="button">Submit</button><br>
</div>
<br>
</body>
</html>
<script>
    (function(){
        $.getScript("javascript/misc/util.js");
        experimentr.hideNext();
        // pages

        var step = 0,
            sec_switch = 0;

        function add_mod_intros(img_address){
            var height = "550px",
                width = "1000px",
                x = "400px",
                y = "20px";

            d3.select("#notation").select(".image").remove();
            var svg = d3.select("#notation")
                .append("svg")
                .attr("class", "image")
                .attr("width", 1800)
                .attr("height", 600);
            svg.append("svg:image")
                .attr("xlink:href","/resources/module_intros/"+img_address)
                .attr("x",x)
                .attr("y",y)
                .attr("width",width)
                .attr("height",height);
            svg.append("rect")
                .attr("x", x)
                .attr("y", y)
                .attr("height", height)
                .attr("width", width)
                .style("stroke", "black")
                .style("fill", "none");
        }

        console.log(experimentr.data());
        add_mod_intros("practice_1.PNG");


        var mod_pages = [1,2,3,4,5,6];

        function goToNext() {
            experimentr.next();
        }

        d3.select('#submitComments')
            .on('click', function () {
                d3.select("#heading").remove();
                d3.select('#submitComments').style("left","2.5%");
                console.log((Date.now()-experimentr.data()["time_of_website_start"])/(1000*60));

                if(step==experimentr.data()["mat"].length-1){
                    goToNext();
//                    if(((Date.now()-experimentr.data()["time_of_website_start"])/(1000*60)) > 1.5){
//                        experimentr.sequence([
//                            'modules/post_study_questionnaire.html',
//                            'modules/end.html'
//                        ]).start();
//                    } else{
//                        goToNext();
//                    }
                }else {
                    if (sec_switch==1 && step in mod_pages) {
                        d3.select('#submitComments').style("left","50%");
                        d3.selectAll(".blocks").remove();
                        d3.select("#notation").html("");
                        switch(step){
                            case 1:
                                add_mod_intros("practice_2.PNG");
                                break;
                            case 2:
                                add_mod_intros("practice_3.PNG");
                                break;
                            case 3:
                                add_mod_intros("practice_4.PNG");
                                break;
                            case 4:
                                add_mod_intros("practice_5.PNG");
                                break;
                            case 5:
                                add_mod_intros("practice_6.PNG");
                                break;
                            default:
                                console.log("end");
                                break;
                        }
                        sec_switch = 0
                    } else {

                        d3.select("#notation").text("Page " + (step + 1).toString() + "/" + (experimentr.data()['mat'].length - 1).toString());

                        setTimeout(function () {
                            d3.selectAll(".blocks").remove();
                            pairs(experimentr.data()["mat"][step - 1], step - 1, experimentr.data()["mat"][step - 1].length, experimentr.data()["mode"]);
                            if (experimentr.data()["mode"] == "Vanilla") {
                                d3.selectAll(".icon").remove();
                            }
                        }, 100);

                        step += 1;
                        sec_switch = 1;

                    }
                }
                // time elapse
                experimentr.data()['switch'][step] = Date.now();
                experimentr.save();
            });
    }());
</script>