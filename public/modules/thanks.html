<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--<title>Title</title>-->
</head>
<body>
<div id="notation" style="text-align:left;">

</div>
<h1><button style="background:none; border:none; margin:0; padding:0;" id="summon_dumpdata"></button></h1><br>
<div id="thanks" style="font-size: 25px">
    <strong>
</div><br><br>
<div id="scoring_info" style="visibility: hidden;">
    <p id="score"></p>
    <div id="dumpdata"></div>
</div>


<!--<button id="submitComments" class="next-button" type="button" style="position: absolute; left: 900px;">Finish</button>-->
</body>
<script>
    (function(){
        experimentr.hideNext();
        var score = parseInt(experimentr.data()["total_score"]);
        var report = "Good job! You have scored "+ score + " out of 36 ("+ Math.floor(score*100/36) +"%).";

        d3.select('#score').text(report);

        delete experimentr.data()['mat'];
        delete experimentr.data()['section2'];
        delete experimentr.data()['practice'];
        delete experimentr.data()['practice2'];
        var l = ['mode', 'open_cell', 'partial_cell', 'close_cell', 'char_display', 'symbol_display','no_display', 'missing', 'checks',
        'indel','replace','transpose','nswap','dswap','diff','freq'];
        var t = '';
        for(i in l){
            t+=experimentr.data()[l[i]]+',';
        }
        console.log(t);
        var k = Object.keys(experimentr.data()),
            t = "";
        for(var i=0;i<k.length;i++){
            t+=k[i]+' : '+JSON.stringify(experimentr.data()[k[i]])+'<br>';
        }
        document.getElementById("dumpdata").innerHTML = t;
        experimentr.save(t);

        d3.select("#summon_dumpdata").on("click", function(){
            d3.select("#scoring_info").style("visibility","visible");
        });

//        d3.select('#submitComments')
//            .on('click', function(){
//                experimentr.next();
//            });
    }());
    function add_mod_intros(img_address){
        var height = "550px",
            width = "1000px",
            x = "400px",
            y = "20px";

        d3.select("#notation").select(".image").remove();
        var svg = d3.select("#notation")
            .append("svg")
            .attr("class", "image")
            .attr("width", 1800)
            .attr("height", 600);
        svg.append("svg:image")
            .attr("xlink:href","/resources/module_intros/"+img_address)
            .attr("x",x)
            .attr("y",y)
            .attr("width",width)
            .attr("height",height);
        svg.append("rect")
            .attr("x", x)
            .attr("y", y)
            .attr("height", height)
            .attr("width", width)
            .style("stroke", "black")
            .style("fill", "none");
    }

    console.log(experimentr.data());
    add_mod_intros("conclusion.png");
</script>

</html>