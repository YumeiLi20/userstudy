<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Questionnaire</title>
    <!--<link href="../css/survey.css" rel="stylesheet">-->
</head>
<body>
<div id="demographics">
    <h1>Pre-Study Survey</h1>

    <p id="demoinstr">
        Please fill out the short survey. The study will begin after you do. No personal information is being collected.
    </p>

    <br>
    <div id="sex">Your gender:
        <!--<div id="sexes">-->
            <input type="radio" id="s1" name="sex" value="Male"> Male
            <input type="radio" id="s2" name="sex" value="Female"> Female
            <input type="radio" id="s3" name="sex" value="Other/Unspecified"> Unspecified
        <!--</div>-->
    </div>
    <br>

    <div id="age">Your age:
        <!--<div id="ages">-->
            <input type="number" name="age" min="10" max="100">
        <!--</div>-->
    </div>
    <br>

    <div id="occupation">Occupation:
        <!--<div id="occupations">-->
            <input type="radio" id="o1" name="occupation" value="Student"> Student
            <input type="radio" id="o2" name="occupation" value="Research Staff"> Research Staff
            <input type="radio" id="o3" name="occupation" value="Faculty"> Faculty
            <input type="radio" id="o4" name="occupation" value="Other"> Other
            <input type="text" id="o5" name="occupation">
        <!--</div>-->
    </div>
    <br>


    <div id="div_student">
        <div id="current_degree">Current Degree obtained:
            <!--<div id="degrees">-->
            <input type="radio" id="d1" name="current_degree" value="High School"> High School
            <input type="radio" id="d2" name="current_degree" value="Bachelors"> Bachelors
            <input type="radio" id="d3" name="current_degree" value="Masters"> Masters
            <input type="radio" id="d4" name="current_degree" value="PhD"> PhD
            <input type="radio" id="d5" name="current_degree" value="Other"> Other
            <input type="text" id="d6" name="current_degree" >
            <!--</div>-->
        </div>
        <br>

        <div id="department" style="display: inline-block">Department:
        </div>


    </div>
    <br>

    <div id="div_highest_degree">Highest Degree obtained:
        <!--<div id="degrees">-->
        <input type="radio" id="h1" name="highest_degree" value="High School"> High School
        <input type="radio" id="h2" name="highest_degree" value="Bachelors"> Bachelors
        <input type="radio" id="h3" name="highest_degree" value="Masters"> Masters
        <input type="radio" id="h4" name="highest_degree" value="PhD"> PhD
        <input type="radio" id="h5" name="highest_degree" value="Other"> Other
        <input type="text" id="h6" name="highest_degree" style="visibility: hidden">
        <!--</div>-->
    </div>
    <br>

    <div id="div_us_age">How long have you lived in the US?
        Years:  <input type="number" name="us_age" id="us_years" min="0" max="100">
        Months: <input type="number" name="us_age" id="us_months" min="0" max="12">
    </div>
    <br>

    <div id="div_country">What country have you lived for the majority of your life?
        <!--<input type="text" id="country" name="country">-->
    </div>
    <br>

    <div id="div_english">Is English your first language?
        <input type="radio" id="e1" name="english" value="Yes"> Yes
        <input type="radio" id="e2" name="english" value="No"> No
    </div>
    <br>

    <div id="div_color">Do you have any known color blindness?
        <input type="radio" id="c1" name="color" value="Yes"> Yes
        <input type="radio" id="c2" name="color" value="No"> No
    </div>
    <br>


    <div id="div_data" style="display: inline-block" style="white-space: nowrap">Please rate your experience working with data or doing any kind of data analysis, including numerical inspection or descriptive statistics, on a scale of 1 to 10:
        <input id="data_ana" name="data_analysis" type="range" min="1" max="10" step="1"  size="5"> <label id="lbl_data_ana" style="display: inline-block"></label>
    </div>
    <br>


    <div id="div_submit">
        <input type="button" id="submitComments" name="button_submit" value="Submit">
    </div>

</div>


<script>
    console.log("Hi! You are now taking the pre-survey!");

    (function() {
        var pre_survey_data = {};
        experimentr.startTimer('pre_survey_timer');
        experimentr.hideNext();


        d3.select("#div_student").style("display","none");
        d3.select("#o5").style("visibility","hidden");
        d3.select("#d6").style("visibility","hidden");

//      get values
        d3.selectAll('input')
            .filter(function(d) { return this.name === 'sex' ? this : null; })
            .on('change', function() { data.sex = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'age' ? this : null; })
            .on('change', function() { data.age = this.value;})


//      If student
        d3.selectAll('input')
            .filter(function(d) { return this.name === 'occupation' ? this : null; })
            .on('change', function() {
               // var selectedoccupation  = d3.select('input[name=occupation]:checked').attr('value');
                if(d3.select("#o4").property("checked")) {
                    d3.select("#o5")
                        .style("visibility","visible");
                    d3.select("#div_student")
                        .style("display","none");
                    d3.select("#d6")
                        .style("visibility","hidden");
                } else {
                    d3.select("#o5")
                        .style("visibility","hidden");
                    if(d3.select("#o1").property("checked")) {
                        d3.select("#div_student")
                            .style("display","inline-block");
                    } else {
                        d3.select("#div_student")
                            .style("display","none");
                    }
                }
                data.occupation = this.value;
                console.log(data.occupation);
            })

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'current_degree' ? this : null; })
            .on('change', function() {
                if(d3.select("#d5").property("checked")) {
                    d3.select("#d6")
                        .style("visibility","visible");
                } else {
                    d3.select("#d6")
                        .style("visibility","hidden");
                }
                data.current_degree = this.value;
            })

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'highest_degree' ? this : null; })
            .on('change', function() {
                if(d3.select("#h5").property("checked")) {
                    d3.select("#h6")
                        .style("visibility","visible");
                } else {
                    d3.select("#h6")
                        .style("visibility","hidden");
                }
                data.highest_degree = this.value;
            })


        d3.csv("../resources/other_data/dept_list.csv", function(error, dt) {
            var select = d3.select("#div_student")
                .append("select")
                .attr("name","dpt")

            select
                .on("change", function(d) {
                    data.department = d3.select(this).property("value");
                    console.log(data.department);
                });

            select.selectAll("option")
                .data(dt)
                .enter()
                .append("option")
                .attr("value", function (d) { return d.four_code; })
                .text(function (d) { return d.four_code; });
        });

        d3.csv("../resources/other_data/countries.csv", function(error, dt) {
            var select = d3.select("#div_country")
                .append("select")
                .attr("name","country")

            select
                .on("change", function(d) {
                    data.country = d3.select(this).property("value");
                    console.log(data.country);
                });

            select.selectAll("option")
                .data(dt)
                .enter()
                .append("option")
                .attr("value", function (d) { return d.countries; })
                .text(function (d) { return d.countries; });
        });

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'us_years' ? this : null; })
            .on('change', function() { data.us_years = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'us_months' ? this : null; })
            .on('change', function() { data.us_months = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'english' ? this : null; })
            .on('change', function() { data.english = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'country' ? this : null; })
            .on('change', function() { data.country = this.value;})


        d3.select("#data_ana").style("width","100px");
        d3.selectAll('input')
            .filter(function(d) { return this.name === 'data_analysis' ? this : null; })
            .on('change', function() {
                console.log(this.value); data.data_analysis_skill = this.value;
                d3.select("#lbl_data_ana").text(function(){return data.data_analysis_skill;});
            })


        //{ return data.data_analysis_skill;})

//      submit
        function goToNext() {
            experimentr.addData(data);
            experimentr.next();
        };

        d3.select('#submitComments')
            .on('click', function () {
                experimentr.endTimer('pre_survey_timer');
                goToNext();
            });
    }());


</script>

    <!--<script>-->
        <!--var pre_survey = document.getElementById("pre_survey");-->
        <!--var pre_survey_form = document.createElement('form');-->
        <!--pre_survey.appendChild(pre_survey_form);-->

        <!--//page heading-->
        <!--var heading = document.createElement('h2'); // Heading of Form-->
        <!--heading.innerHTML = "Pre Study Questionnaire";-->
        <!--pre_survey_form.appendChild(heading);-->

<!--//        var line = document.createElement('hr'); // Giving Horizontal Row After Heading-->
<!--//        pre_survey_form.appendChild(line);-->
        <!--var linebreak = document.createElement('br');-->
        <!--pre_survey_form.appendChild(linebreak);-->

        <!--//text label-->
        <!--var namelabel = document.createElement('label'); // Create Label for Name Field-->
        <!--namelabel.innerHTML = "Gender : "; // Set Field Labels-->
        <!--pre_survey_form.appendChild(namelabel);-->

        <!--//text field-->
        <!--var inputelement = document.createElement('input'); // Create Input Field for Name-->
        <!--inputelement.setAttribute("type", "radio    ");-->
        <!--inputelement.setAttribute("name", "dname");-->
        <!--pre_survey_form.appendChild(inputelement);-->

<!--//        break-->
        <!--var name_linebreak = document.createElement('br')-->
        <!--pre_survey_form.appendChild(name_linebreak);-->



        <!--var messagebreak = document.createElement('br');-->
        <!--pre_survey_form.appendChild(messagebreak);-->

        <!--var end = document.createElement('p');-->
        <!--pre_survey_form.appendChild(end);-->
        <!--end.innerHTML = "End of page";-->

    <!--</script>-->
    <!--&lt;!&ndash;<script src="javascript/misc/survey.js"> </script>&ndash;&gt;-->
</body>
</html>