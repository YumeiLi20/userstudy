<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pre Study Survey</title>
    <!--<link href="../css/survey.css" rel="stylesheet">-->
</head>
<body>
<div id="demographics">
    <div  style="width: 1000px; position: absolute; top: 25px;">
    <!--<h3 style="text-align: center">Survey</h3>-->

    <h4 id="demoinstr" style="text-align: center; font-weight: bold">
        Please fill out this short questionnaire before you proceed to the study:
    </h4>
        <hr>
    </div>

    <form>
    <br>
    <div id="sex" style="position: absolute; left: 0px; width: 740px;  text-align: right; top: 100px;">1. Gender: </div>
        <div id="sexes" style="position: absolute; left: 750px; top: 100px">
            <input type="radio" id="s1" name="sex" value="Male"> Male &nbsp;&nbsp;
            <input type="radio" id="s2" name="sex" value="Female"> Female &nbsp;&nbsp;
            <input type="radio" id="s3" name="sex" value="Prefer not to disclose"> Prefer not to disclose
        </div>
    <br>

    <div id="age" style="position: absolute; left:0px; width: 740px;  text-align: right; top: 150px">2. Age:
    </div>
        <div id="ages" style="position: absolute; left: 750px; top: 150px">
        <input type="number" name="age" min="18" max="100">
        </div>
    <br>

    <svg  height="10px" width="750px" style="position: absolute; left:450px; top: 185px">
        <line x1="0" y1="5" x2="750" y2="5" style="stroke:grey;stroke-width:1"></line>
    </svg>

    <div id="occupation" style="position: absolute; left:0px; width: 740px;  text-align: right; top: 200px">3. Occupation:
    </div>
        <div id="occupations" style="position: absolute; left: 750px; top: 200px">
        <input type="radio" id="o1" name="occupation" value="Student"> Student &nbsp;&nbsp;
        <input type="radio" id="o2" name="occupation" value="Research Staff"> Research Staff &nbsp;&nbsp;
        <input type="radio" id="o3" name="occupation" value="Faculty"> Faculty &nbsp;&nbsp;
        <input type="radio" id="o4" name="occupation" value="Other"> Other &nbsp;
        <input type="text" id="o5" name="occupation">
        </div>
    <br>


    <div id="div_student" name="div_stud">
        <div id="current_degree" style="position: absolute; left:0px; width: 740px;  text-align: right;  top: 250px">3.1. Current Degree (If student):
        </div>
        <div id="degrees" style="position: absolute; left: 750px; top: 250px">
            <input type="radio" id="d1" name="current_degree" value="High School"> High School &nbsp;&nbsp;
            <input type="radio" id="d2" name="current_degree" value="Bachelors"> Bachelors &nbsp;&nbsp;
            <input type="radio" id="d3" name="current_degree" value="Masters"> Masters &nbsp;&nbsp;
            <input type="radio" id="d4" name="current_degree" value="PhD"> PhD &nbsp;&nbsp;
            <input type="radio" id="d5" name="current_degree" value="Other"> Other &nbsp;
            <input type="text" id="d6" name="current_degree" >
        </div>

        <div id="department"  style="position: absolute; left: 0px;width: 740px;  text-align: right; top: 300px">3.2. Department (If student):
        </div>

        <div>
            <input type="text" id="dpt" name="dpt" style="position: absolute; left: 750px; top: 300px" disabled="true">
        </div>


    </div>
    <br>

    <div id="div_highest_degree" style="position: absolute; left: 0px;width: 740px;  text-align: right;  top: 350px">4. Highest Degree obtained:
    </div>
        <div id="degrees_2" style="position: absolute; left: 750px; top: 350px">
        <input type="radio" id="h1" name="highest_degree" value="High School"> High School &nbsp;&nbsp;
        <input type="radio" id="h2" name="highest_degree" value="Bachelors"> Bachelors &nbsp;&nbsp;
        <input type="radio" id="h3" name="highest_degree" value="Masters"> Masters &nbsp;&nbsp;
        <input type="radio" id="h4" name="highest_degree" value="PhD"> PhD &nbsp;&nbsp;
        <input type="radio" id="h5" name="highest_degree" value="Other"> Other &nbsp;
        <input type="text" id="h6" name="highest_degree" style="visibility: hidden">
        </div>
    <br>

    <svg  height="10px" width="750px" style="position: absolute; left:450px; top: 385px">
        <line x1="0" y1="5" x2="750" y2="5" style="stroke:grey;stroke-width:1"></line>
    </svg>

    <div id="div_us_age" style="position: absolute; left: 0px;width: 740px;  text-align: right;  top: 400px">5. Length of stay in the US:
    </div>
        <div style="position: absolute; left: 750px; top: 400px">
        <input type="number" name="us_age" id="us_years" min="0" max="100"> Years &nbsp;
        <input type="number" name="us_age" id="us_months" min="0" max="12"> Months
        </div>
    <br>

    <div id="div_country"  style="position: absolute; left: 0px;width: 740px;  text-align: right;  top: 450px">
        6. Country you lived the majority of your life:
    </div>
    <div>
        <input type="text" id="country_txt" name="country" style="position: absolute; left: 750px; top: 450px">
    </div>
    <br>

    <div id="div_english" style="position: absolute; left: 0px;width: 740px;  text-align: right;  top: 500px">
        7. Is English your first language?
    </div>
    <div style="position: absolute; left: 750px; top: 500px">
        <input type="radio" id="e1" name="english" value="Yes"> Yes &nbsp;&nbsp;
        <input type="radio" id="e2" name="english" value="No"> No
    </div>
    <br>

    <div id="div_color" style="position: absolute; left: 0px;width: 740px;  text-align: right;  top: 550px">
        8. Do you have any known color blindness?
    </div>
    <div style="position: absolute; left: 750px; top: 550px">
        <input type="radio" id="c1" name="color" value="Yes"> Yes &nbsp;&nbsp;
        <input type="radio" id="c2" name="color" value="No"> No
    </div>
    <br>

    <svg  height="10px" width="750px" style="position: absolute; left:450px; top: 585px">
        <line x1="0" y1="5" x2="750" y2="5" style="stroke:grey;stroke-width:1"></line>
    </svg>

    <div id="div_data" style="position: absolute; left: 400px;width: 340px;  text-align: right;  top: 600px">
        9. Rate your experience working with data or doing data analysis, including numerical inspection or descriptive statistics on a scale of 1 to 10:
        <!--<br>(1 being very inexperienced and 10 being very experienced)-->
    </div>
    <div style="position: absolute; left: 750px; top: 610px">
        <!--<input type="number" id="data_ana" name="data_ana" min="1" max="10">-->
        <input type="radio" name="data_ana" value="1"> 1 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="2"> 2 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="3"> 3 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="4"> 4 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="5"> 5 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="6"> 6 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="7"> 7 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="8"> 8 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="9"> 9 &nbsp;&nbsp;
        <input type="radio" name="data_ana" value="10"> 10<br>
        <img src="/resources/scale2.png" width="400px" height="40px">
    </div>
    <div  style="position: absolute; left: 0px;width: 740px;  text-align: right;  top: 685px">
        Briefly explain:
    </div>
        <textarea name="data_ana_text" rows="4" cols="50" style="position: absolute; left: 750px;  top: 685px">

        </textarea>
    <br>


    <div id="div_submit">
        <input type="button" id="submitComments" name="button_submit" value="Submit" style="position: absolute; left: 725px;  top: 800px">
    </div>

    </form>

</div>


<script>
    console.log("Hi! You are now taking the pre-survey!");

    (function() {
        var pre_survey_data = {};
        experimentr.startTimer('pre_survey_timer');
        experimentr.hideNext();

        d3.select("#o5").style("visibility","hidden");
        d3.select("#d6").style("visibility","hidden");

//      get values
        d3.selectAll('input')
            .filter(function(d) { return this.name === 'sex' ? this : null; })
            .on('change', function() { data.preSurvey_sex = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'age' ? this : null; })
            .on('change', function() { data.preSurvey_age = this.value;})


        //function used to enable and disable student div
        function disable_stud(status) {
            if(status){
                d3.select("#current_degree").style("color","#b3b3b3");
                d3.select("#degrees").style("color","#b3b3b3");
                d3.select("#department").style("color","#b3b3b3");
                for(i=1;i<7;i++) {
                    d3.select('#d'+i).attr("disabled","true").property("checked","false");
                }
                d3.select("#dpt").attr("disabled",true).attr("value","").property("value","");
                data.preSurvey_current_degree = null;
                data.preSurvey_department=null;
            } else {
                d3.select("#current_degree").style("color","black");
                d3.select("#degrees").style("color","black");
                d3.select("#department").style("color","black");
                for(i=1;i<7;i++) {
                    d3.select('#d'+i).attr("disabled",null);
                }
                d3.select("#dpt").attr("disabled",null);
            }
        }

        disable_stud(true);
//      If student
        d3.selectAll('input')
            .filter(function(d) { return this.name === 'occupation' ? this : null; })
            .on('change', function() {
                disable_stud(true);
                if(d3.select("#o4").property("checked")) {
                    d3.select("#o5")
                        .style("visibility","visible");
                    d3.select("#d6")
                        .style("visibility","hidden");
                } else {
                    d3.select("#o5")
                        .style("visibility","hidden");
                    if(d3.select("#o1").property("checked")) {
                        disable_stud(false);
                    }
                }
                data.preSurvey_occupation = this.value;
                console.log(data.preSurvey_occupation);
            })

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'current_degree' ? this : null; })
            .on('change', function() {
                if(d3.select("#d5").property("checked")) {
                    d3.select("#d6")
                        .style("visibility","visible");
                } else {
                    d3.select("#d6")
                        .style("visibility","hidden");
                }
                data.preSurvey_current_degree = this.value;
            })

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'highest_degree' ? this : null; })
            .on('change', function() {
                if(d3.select("#h5").property("checked")) {
                    d3.select("#h6")
                        .style("visibility","visible");
                } else {
                    d3.select("#h6")
                        .style("visibility","hidden");
                }
                data.preSurvey_highest_degree = this.value;
            })



        d3.select("#us_years")
            .on('change',function() {
                data.preSurvey_us_years = this.value;
            })

        d3.select("#us_months")
            .on('change',function() {
                data.preSurvey_us_months = this.value;
            })

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'color' ? this : null; })
            .on('change', function() { data.preSurvey_color = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'english' ? this : null; })
            .on('change', function() { data.preSurvey_english = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'country' ? this : null; })
            .on('change', function() { data.preSurvey_country = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'dpt' ? this : null; })
            .on('change', function() { data.preSurvey_department = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'color' ? this : null; })
            .on('change', function() { data.preSurvey_color_blind = this.value;})

        d3.selectAll('input')
            .filter(function(d) { return this.name === 'data_ana' ? this : null; })
            .on('change', function() { data.preSurvey_data_analysis_skill = this.value;})


        d3.selectAll('textarea')
            .filter(function(d) { return this.name === 'data_ana_text' ? this : null; })
            .on('change', function() { data.preSurvey_data_experience_explanation = this.value;})


        d3.select("#data_ana").style("width","100px");
        d3.selectAll('input')
            .filter(function(d) { return this.name === 'data_analysis' ? this : null; })
            .on('change', function() {
                console.log(this.value); data.preSurvey_data_analysis_skill = this.value;
                d3.select("#lbl_data_ana").text(function(){return data.preSurvey_data_analysis_skill;});
            })


        //{ return data.preSurvey_data_analysis_skill;})

//      submit
        function goToNext() {
            experimentr.addData(data);
            experimentr.data()['switch'].push(Date.now());
            experimentr.next();
        };

        d3.select('#submitComments')
            .on('click', function () {
                console.log("submit");
                experimentr.endTimer('pre_survey_timer');
                goToNext();
            });

        //        d3.csv("../resources/other_data/dept_list.csv", function(error, dt) {
//            var select = d3.select("#div_student")
//                .append("select")
//                .attr("name","dpt")
//                .attr("id","dept")
//                .attr("disabled","true")
//                .style("position","absolute")
//                .style("left", "350px")
//                .style("top", "300px");
//
//            select
//                .on("change", function(d) {
//                    data.department = d3.select(this).property("value");
//                    console.log(data.department);
//                });
//
//            select.selectAll("option")
//                .data(dt)
//                .enter()
//                .append("option")
//                .attr("value", function (d) { return d.four_code; })
//                .text(function (d) { return d.four_code; });
//        });

//        d3.csv("../resources/other_data/countries.csv", function(error, dt) {
//            var select = d3.select("#country_choices")
//                .append("select")
//                .attr("name","country")
//                .style("position","absolute")
//                .style("left", "350px")
//                .style("top", "450px");
//
//            select
//                .on("change", function(d) {
//                    data.country = d3.select(this).property("value");
//                    console.log(data.country);
//                });
//
//            select.selectAll("option")
//                .data(dt)
//                .enter()
//                .append("option")
//                .attr("value", function (d) { return d.countries; })
//                .text(function (d) { return d.countries; });
//        });

    }());


</script>
</body>
</html>